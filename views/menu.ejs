<!DOCTYPE html>
<html>
  <head>
    <!--Import Google Icon Font-->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <!--Import materialize.css-->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">
    <link rel="stylesheet" href="/css/stylesheet.css">
    <!--Let browser know website is optimized for mobile-->
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  </head>

  <body>
      <nav>
          <div class="nav-wrapper">
            <a href="#!" class="brand-logo">Logo</a>
            <a href="#" data-target="mobile-demo" class="sidenav-trigger"><i class="material-icons">Menu</i></a>
            <ul class="right hide-on-med-and-down">
                <%if (!user){ %>
              <li><a href="/login">Login</a></li>
              <li><a href="/signup">Signup</a></li>
              <%}%>
              <%if (user){ %>
              <li><a href="/logout">Logout</a></li>
              <%}%>
            </ul>
          </div>
        </nav>

        <ul class="sidenav" id="mobile-demo">
            <%if (!user){ %>
              <li><a href="/login">Login</a></li>
              <li><a href="/signup">Signup</a></li>
              <%}%>
              <%if (user){ %>
              <li><a href="/logout">Logout</a></li>
              <%}%>
          </ul>
     
    <div class="row1 center-block">
      <div class="top-label"><p class="center code "><%=code%></p></div>
      <div class="bk-img">
      
      </div>
            <%if (products && products.length){ %>

                  <ul class="collapsible">
                      <% for (var i=0; i < products.length; i++){%>
                          <li> <div class="collapsible-header value1"><%=products[i].name %></span></div>
                            <div class="collapsible-body" > 
                            <div class="row">
                                <div class="col s2"><b>Price:</b></div>
                                <div class="col s8"><span class="value2"> <%=products[i].price %> </span></div>
                                <div class="col s2"><button  class="btn-small  waves effect btn-order">Order</button></div>
                                </div>
                              </div></li>
                          <%}%>
                 
                   </ul><%}%>
    </div>
 
    <div class="row2 center-block ">

        <p class="order-title center "> <b>Your Order</b></p>
        <div class="summary"></div>
       <div class="order-row row"  >    <div class="col s12"><button class="submit btn-small waves-effect center " >submit</button></div></div>
    
</div>

      



   
      <script src="/jquery/jquery.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
  <script> 
   document.addEventListener('DOMContentLoaded', function() {
      
        var elems = document.querySelectorAll('.sidenav');
        var instances = M.Sidenav.init(elems);
      });

      document.addEventListener('DOMContentLoaded', function() {
        var elems = document.querySelectorAll('.collapsible');
        var instances = M.Collapsible.init(elems);
      });

      $(document).ready(function(){
        var order=[];
        $('.row2').css({display:'none'});
         var j;
     
        $(".btn-order").click(function(){
          var j=1;
          $('.row2').css({display:'block'});
          
      var val1=  $(".active").children("div.value1").text();
      var val2=  $(".active").find("span.value2").text();
      var code = $(".code").text();
      order.push({"name":val1, "price":val2, "code":code});
    console.log(order);  
    
     
   var element = $('<div class="row order-row"><div class="col s9 details"><button class="btn-floating waves-effect minus" >-</button><button class="btn-floating waves-effect plus">+</button><span class="j">'+j +'</span>x ' + order[order.length - 1].name +'</div> <div class="col s3 price"><b>'
    + order[order.length - 1].price +'</b></div></div>') ;
   
   $('.summary').append(element);

   $(".minus", element).click(function(){
        if (   $(this).siblings("span.j").text() > 1){
           j-- ;
           $(this).siblings("span.j").text(j);
           
          /**/
           
        }else{  $(this).parents("div.row").remove();}
        
         //  $(".j").text(j);
          });
     $(".plus",element).click(function(){
      if (   $(this).siblings("span.j").text() < 4){
        j++;
        $(this).siblings("span.j").text(j);
      }
          });    
        
          $(".submit").click(function(){
  localStorage.setItem('order',JSON.stringify(order))
window.location.href="/cart"
       
        
        });       

})
        
        

          
    })
    

     /* var ordermenu=[];
     
      function order(){
     
      var value1=document.querySelector('.value1').innerHTML;
        var value2=document.querySelector('.value2').innerHTML;
        ordermenu.push({"name":value1, "quantity":value2});
       console.log(ordermenu);
       console.log(value1);
      }

      var quantity= 1;
      function add(){
      var field=document.getElementById('quantity');
       field.value =quantity;
       quantity ++;
    }
*/
     

     
</script>
    
  </body>
</html>